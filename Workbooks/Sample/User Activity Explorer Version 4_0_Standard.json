{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## User Activity Explorer"
      },
      "name": "Title"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ccd5adcd-8d59-4cfe-99ec-98075de2e253",
            "version": "KqlParameterItem/1.0",
            "name": "DefaultSubscription_Internal",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| take 1\r\n| project subscriptionId",
            "crossComponentResources": [
              "value::selected"
            ],
            "isHiddenWhenLocked": true,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "1ca69445-60fc-4806-b43d-ac7e6aad630a",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "query": "summarize by subscriptionId\r\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)\r\n",
            "crossComponentResources": [
              "value::selected"
            ],
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "e94aafa3-c5d9-4523-89f0-4e87aa754511",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\n| project id",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "value": "/subscriptions/74f0db80-614b-4242-a56f-da0c0da36ff0/resourceGroups/lianbio-prod-sentinel/providers/Microsoft.OperationalInsights/workspaces/lianbio-prod-sentinel-workspace",
            "typeSettings": {
              "resourceTypeFilter": {
                "microsoft.operationalinsights/workspaces": true
              },
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "e028303b-1d06-4ba3-9d8d-69517a6c22e3",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "Time Range",
            "type": 4,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "value": {
              "durationMs": 86400000
            }
          },
          {
            "id": "2e55fc42-7a80-40bd-b0c9-191318da8b52",
            "version": "KqlParameterItem/1.0",
            "name": "switchTabs",
            "type": 1,
            "isHiddenWhenLocked": true,
            "value": "Azure_AD_Activity"
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "toolbar",
        "links": [
          {
            "id": "b6cb85d2-f92b-4968-a360-57d9e9fc6779",
            "cellValue": "switchTabs",
            "linkTarget": "parameter",
            "linkLabel": "CloudApps Activity",
            "subTarget": "CloudApps_Activity",
            "style": "link"
          },
          {
            "id": "dd4ec971-4d80-407b-ae53-370c8e1af4ee",
            "cellValue": "switchTabs",
            "linkTarget": "parameter",
            "linkLabel": "Device Logon Activity (MDE)",
            "subTarget": "Device_Logon_Activity",
            "style": "link"
          },
          {
            "id": "3c2962bb-e38d-4ca4-a903-507a4496de1f",
            "cellValue": "switchTabs",
            "linkTarget": "parameter",
            "linkLabel": "Office Activity",
            "subTarget": "Office_Activity",
            "style": "link"
          }
        ]
      },
      "name": "ToolTabs"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CloudApps Activity",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "b80922a6-5156-4957-b7d6-b50910492f37",
                  "version": "KqlParameterItem/1.0",
                  "name": "Para_CloudApps_AccountDisplayName",
                  "label": "DisplayName",
                  "type": 1,
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "CloudApps Parameters"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "CloudAppEvents\r\n| where AccountDisplayName contains \"{Para_CloudApps_AccountDisplayName}\"\r\n| summarize Count = count() by AccountDisplayName\r\n| sort by Count desc",
              "size": 0,
              "timeContextFromParameter": "TimeRange",
              "exportMultipleValues": true,
              "exportedParameters": [
                {
                  "fieldName": "AccountDisplayName",
                  "parameterName": "CloudApps_AccountDisplayName",
                  "parameterType": 1
                }
              ],
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AccountDisplayName",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              },
              "graphSettings": {
                "type": 0,
                "topContent": {
                  "columnMatch": "AccountDisplayName",
                  "formatter": 1
                },
                "centerContent": {
                  "columnMatch": "Count",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "User Filter"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "11d42f92-68f3-491b-aff9-9bbd5ab2c6ee",
                  "version": "KqlParameterItem/1.0",
                  "name": "CloudApps_Application",
                  "label": "Application",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "let CloudApps_AccountDisplayNames = dynamic([{CloudApps_AccountDisplayName}]);\r\nCloudAppEvents\r\n| where AccountDisplayName in (CloudApps_AccountDisplayNames)\r\n| distinct Application",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "CloudApps_Parameters",
            "styleSettings": {
              "maxWidth": "13%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let CloudApps_AccountDisplayNames = dynamic([{CloudApps_AccountDisplayName}]);\r\nCloudAppEvents\r\n| where AccountDisplayName in (CloudApps_AccountDisplayNames)\r\n| summarize Count = count() by Application\r\n| sort by Count desc",
              "size": 0,
              "noDataMessage": "Select a user to start.",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AccountDisplayName",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "Application Filter",
            "styleSettings": {
              "maxWidth": "20%"
            }
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "22cd140f-806d-4442-a700-78d2781098ef",
                  "version": "KqlParameterItem/1.0",
                  "name": "CloudApps_ActionType",
                  "label": "ActionType",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "let CloudApps_AccountDisplayNames = dynamic([{CloudApps_AccountDisplayName}]);\r\nlet CloudApps_Applications = dynamic([{CloudApps_Application}]);\r\nCloudAppEvents\r\n| where AccountDisplayName in (CloudApps_AccountDisplayNames)\r\n| where Application in (CloudApps_Applications)\r\n| distinct ActionType",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "CloudApps_Parameters",
            "styleSettings": {
              "maxWidth": "13%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let CloudApps_AccountDisplayNames = dynamic([{CloudApps_AccountDisplayName}]);\r\nlet CloudApps_Applications = dynamic([{CloudApps_Application}]);\r\nCloudAppEvents\r\n| where AccountDisplayName in (CloudApps_AccountDisplayNames)\r\n| where Application in (CloudApps_Applications)\r\n| summarize Count = count() by ActionType\r\n| sort by Count desc",
              "size": 0,
              "noDataMessage": "Select a account from the left filter.",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ActionType",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "ActionType Filter",
            "styleSettings": {
              "maxWidth": "20%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let CloudApps_AccountDisplayNames = dynamic([{CloudApps_AccountDisplayName}]);\r\nlet CloudApps_Applications = dynamic([{CloudApps_Application}]);\r\nlet CloudApps_ActionTypes = dynamic([{CloudApps_ActionType}]);\r\nCloudAppEvents\r\n| where AccountDisplayName in (CloudApps_AccountDisplayNames)\r\n| where Application in (CloudApps_Applications)\r\n| where ActionType in (CloudApps_ActionTypes)\r\n\r\n\r\n\r\n",
              "size": 0,
              "noDataMessage": "Select para from the above filter.",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "exportedParameters": [
                {
                  "fieldName": "TenantId",
                  "parameterName": "TenantId",
                  "parameterType": 1
                },
                {
                  "fieldName": "AccountId",
                  "parameterName": "AccountId",
                  "parameterType": 1
                },
                {
                  "fieldName": "AccountType",
                  "parameterName": "AccountType",
                  "parameterType": 1
                },
                {
                  "fieldName": "AdditionalFields",
                  "parameterName": "AdditionalFields",
                  "parameterType": 1
                },
                {
                  "fieldName": "RawEventData",
                  "parameterName": "RawEventData",
                  "parameterType": 1
                },
                {
                  "fieldName": "ReportId",
                  "parameterName": "ReportId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ObjectId",
                  "parameterName": "ObjectId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ObjectType",
                  "parameterName": "ObjectType",
                  "parameterType": 1
                },
                {
                  "fieldName": "ObjectName",
                  "parameterName": "ObjectName",
                  "parameterType": 1
                },
                {
                  "fieldName": "ActivityObjects",
                  "parameterName": "ActivityObjects",
                  "parameterType": 1
                },
                {
                  "fieldName": "ActivityType",
                  "parameterName": "ActivityType",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserAgent",
                  "parameterName": "UserAgent",
                  "parameterType": 1
                },
                {
                  "fieldName": "ISP",
                  "parameterName": "ISP",
                  "parameterType": 1
                },
                {
                  "fieldName": "City",
                  "parameterName": "City",
                  "parameterType": 1
                },
                {
                  "fieldName": "CountryCode",
                  "parameterName": "CountryCode",
                  "parameterType": 1
                },
                {
                  "fieldName": "IsAnonymousProxy",
                  "parameterName": "IsAnonymousProxy",
                  "parameterType": 1
                },
                {
                  "fieldName": "IsExternalUser",
                  "parameterName": "IsExternalUser",
                  "parameterType": 1
                },
                {
                  "fieldName": "IsImpersonated",
                  "parameterName": "IsImpersonated",
                  "parameterType": 1
                },
                {
                  "fieldName": "IPAddress",
                  "parameterName": "IPAddress",
                  "parameterType": 1
                },
                {
                  "fieldName": "IPCategory",
                  "parameterName": "IPCategory",
                  "parameterType": 1
                },
                {
                  "fieldName": "IPTags",
                  "parameterName": "IPTags",
                  "parameterType": 1
                },
                {
                  "fieldName": "OSPlatform",
                  "parameterName": "OSPlatform",
                  "parameterType": 1
                },
                {
                  "fieldName": "DeviceType",
                  "parameterName": "DeviceType",
                  "parameterType": 1
                },
                {
                  "fieldName": "IsAdminOperation",
                  "parameterName": "IsAdminOperation",
                  "parameterType": 1
                },
                {
                  "fieldName": "AccountDisplayName",
                  "parameterName": "AccountDisplayName",
                  "parameterType": 1
                },
                {
                  "fieldName": "AccountObjectId",
                  "parameterName": "AccountObjectId",
                  "parameterType": 1
                },
                {
                  "fieldName": "AppInstanceId",
                  "parameterName": "AppInstanceId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ApplicationId",
                  "parameterName": "ApplicationId",
                  "parameterType": 1
                },
                {
                  "fieldName": "Application",
                  "parameterName": "Application",
                  "parameterType": 1
                },
                {
                  "fieldName": "ActionType",
                  "parameterName": "ActionType",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserAgentTags",
                  "parameterName": "UserAgentTags",
                  "parameterType": 1
                },
                {
                  "fieldName": "TimeGenerated",
                  "parameterName": "TimeGenerated",
                  "parameterType": 1
                },
                {
                  "fieldName": "Timestamp",
                  "parameterName": "Timestamp",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceSystem",
                  "parameterName": "SourceSystem",
                  "parameterType": 1
                },
                {
                  "fieldName": "Type",
                  "parameterName": "Type",
                  "parameterType": 1
                }
              ],
              "showExportToExcel": true,
              "exportToExcelOptions": "all",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "TenantId",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "AccountId",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "ReportId",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "ObjectId",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "AccountObjectId",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "AppInstanceId",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "ApplicationId",
                    "formatter": 5
                  }
                ],
                "rowLimit": 1000,
                "filter": true,
                "sortBy": [
                  {
                    "itemKey": "$gen_link_AdditionalFields_3",
                    "sortOrder": 1
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_link_AdditionalFields_3",
                  "sortOrder": 1
                }
              ]
            },
            "name": "CloudApps ResultList"
          },
          {
            "type": 1,
            "content": {
              "json": "- TenantId **{TenantId}**\r\n- AccountId **{AccountId}**\r\n- AccountType **{AccountType}**\r\n- AdditionalFields **{AdditionalFields}**\r\n- RawEventData **{RawEventData}**\r\n- ReportId **{ReportId}**\r\n- ObjectId **{ObjectId}**\r\n- ObjectType **{ObjectType}**\r\n- ObjectName **{ObjectName}**\r\n- ActivityObjects **{ActivityObjects}**\r\n- ActivityType **{ActivityType}**\r\n- UserAgent **{UserAgent}**\r\n- ISP **{ISP}**\r\n- City **{City}**\r\n- CountryCode **{CountryCode}**\r\n- IsAnonymousProxy **{IsAnonymousProxy}**\r\n- IsExternalUser **{IsExternalUser}**\r\n- IsImpersonated **{IsImpersonated}**\r\n- IPAddress **{IPAddress}**\r\n- IPCategory **{IPCategory}**\r\n- IPTags **{IPTags}**\r\n- OSPlatform **{OSPlatform}**\r\n- DeviceType **{DeviceType}**\r\n- IsAdminOperation **{IsAdminOperation}**\r\n- AccountDisplayName **{AccountDisplayName}**\r\n- AccountObjectId **{AccountObjectId}**\r\n- AppInstanceId **{AppInstanceId}**\r\n- ApplicationId **{ApplicationId}**\r\n- Application **{Application}**\r\n- ActionType **{ActionType}**\r\n- UserAgentTags **{UserAgentTags}**\r\n- TimeGenerated **{TimeGenerated}**\r\n- Timestamp **{Timestamp}**\r\n- SourceSystem **{SourceSystem}**\r\n- Type **{Type}**"
            },
            "name": "CloudApps Result Detail"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "switchTabs",
        "comparison": "isEqualTo",
        "value": "CloudApps_Activity"
      },
      "name": "CloudApps Activity"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Device Logon Activity",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "953e2058-fde5-452c-9413-9717e1160e9f",
                  "version": "KqlParameterItem/1.0",
                  "name": "Para_Device_Logon_Activity_AccountName",
                  "label": "AccountName",
                  "type": 1,
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "Device_Logon_Parameters"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DeviceLogonEvents\r\n| where AccountName contains \"{Para_Device_Logon_Activity_AccountName}\"\r\n| summarize Count = count() by AccountName\r\n| sort by Count desc",
              "size": 0,
              "timeContextFromParameter": "TimeRange",
              "exportMultipleValues": true,
              "exportedParameters": [
                {
                  "fieldName": "AccountName",
                  "parameterName": "Device_Logon_AccountName",
                  "parameterType": 1
                }
              ],
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AccountName",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "name": "User Filter"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "c587d4bf-4f6d-4482-a56b-3333f4e7feba",
                  "version": "KqlParameterItem/1.0",
                  "name": "Device_Logon_DeviceName",
                  "label": "DeviceName",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "let Device_Logon_AccountNames = dynamic([{Device_Logon_AccountName}]);\r\nDeviceLogonEvents\r\n| where AccountName in (Device_Logon_AccountNames)\r\n| distinct DeviceName",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ]
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "Device_Logon_Parameters",
            "styleSettings": {
              "maxWidth": "13%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Device_Logon_AccountNames = dynamic([{Device_Logon_AccountName}]);\r\nDeviceLogonEvents\r\n| where AccountName in (Device_Logon_AccountNames)\r\n| summarize Count = count() by DeviceName\r\n| sort by Count desc",
              "size": 0,
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ActionType",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "Device Filter",
            "styleSettings": {
              "maxWidth": "20%"
            }
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "bc7d70a6-3e93-4819-9a7b-2c3e73f65ea3",
                  "version": "KqlParameterItem/1.0",
                  "name": "Device_Logon_ActionType",
                  "label": "ActionType",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "let Device_Logon_AccountNames = dynamic([{Device_Logon_AccountName}]);\r\nlet Device_Logon_DeviceNames = dynamic([{Device_Logon_DeviceName}]);\r\nDeviceLogonEvents\r\n| where AccountName in (Device_Logon_AccountNames)\r\n| where DeviceName in (Device_Logon_DeviceNames)\r\n| distinct ActionType",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "Device_Logon_Parameters",
            "styleSettings": {
              "maxWidth": "13%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Device_Logon_AccountNames = dynamic([{Device_Logon_AccountName}]);\r\nlet Device_Logon_DeviceNames = dynamic([{Device_Logon_DeviceName}]);\r\nDeviceLogonEvents\r\n| where AccountName in (Device_Logon_AccountNames)\r\n| where DeviceName in (Device_Logon_DeviceNames)\r\n| summarize Count = count() by ActionType\r\n| sort by Count desc",
              "size": 0,
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ActionType",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "ActionType Filter",
            "styleSettings": {
              "maxWidth": "33%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Device_Logon_AccountNames = dynamic([{Device_Logon_AccountName}]);\r\nlet Device_Logon_ActionTypes = dynamic([{Device_Logon_ActionType}]);\r\nlet Device_Logon_DeviceNames = dynamic([{Device_Logon_DeviceName}]);\r\nDeviceLogonEvents\r\n| where AccountName in (Device_Logon_AccountNames)\r\n| where ActionType in (Device_Logon_ActionTypes)\r\n| where DeviceName in (Device_Logon_DeviceNames)",
              "size": 0,
              "noDataMessage": "Select para from the above filter.",
              "timeContext": {
                "durationMs": 86400000
              },
              "showRefreshButton": true,
              "exportedParameters": [
                {
                  "fieldName": "TenantId",
                  "parameterName": "TenantId",
                  "parameterType": 1
                },
                {
                  "fieldName": "AccountDomain",
                  "parameterName": "AccountDomain",
                  "parameterType": 1
                },
                {
                  "fieldName": "AccountName",
                  "parameterName": "AccountName",
                  "parameterType": 1
                },
                {
                  "fieldName": "AccountSid",
                  "parameterName": "AccountSid",
                  "parameterType": 1
                },
                {
                  "fieldName": "ActionType",
                  "parameterName": "ActionType",
                  "parameterType": 1
                },
                {
                  "fieldName": "AdditionalFields",
                  "parameterName": "AdditionalFields",
                  "parameterType": 1
                },
                {
                  "fieldName": "AppGuardContainerId",
                  "parameterName": "AppGuardContainerId",
                  "parameterType": 1
                },
                {
                  "fieldName": "DeviceId",
                  "parameterName": "DeviceId",
                  "parameterType": 1
                },
                {
                  "fieldName": "DeviceName",
                  "parameterName": "DeviceName",
                  "parameterType": 1
                },
                {
                  "fieldName": "FailureReason",
                  "parameterName": "FailureReason",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessAccountDomain",
                  "parameterName": "InitiatingProcessAccountDomain",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessAccountName",
                  "parameterName": "InitiatingProcessAccountName",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessAccountObjectId",
                  "parameterName": "InitiatingProcessAccountObjectId",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessAccountSid",
                  "parameterName": "InitiatingProcessAccountSid",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessAccountUpn",
                  "parameterName": "InitiatingProcessAccountUpn",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessCommandLine",
                  "parameterName": "InitiatingProcessCommandLine",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessFileName",
                  "parameterName": "InitiatingProcessFileName",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessFolderPath",
                  "parameterName": "InitiatingProcessFolderPath",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessId",
                  "parameterName": "InitiatingProcessId",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessIntegrityLevel",
                  "parameterName": "InitiatingProcessIntegrityLevel",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessMD5",
                  "parameterName": "InitiatingProcessMD5",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessParentFileName",
                  "parameterName": "InitiatingProcessParentFileName",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessParentId",
                  "parameterName": "InitiatingProcessParentId",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessSHA1",
                  "parameterName": "InitiatingProcessSHA1",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessSHA256",
                  "parameterName": "InitiatingProcessSHA256",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessTokenElevation",
                  "parameterName": "InitiatingProcessTokenElevation",
                  "parameterType": 1
                },
                {
                  "fieldName": "IsLocalAdmin",
                  "parameterName": "IsLocalAdmin",
                  "parameterType": 1
                },
                {
                  "fieldName": "LogonId",
                  "parameterName": "LogonId",
                  "parameterType": 1
                },
                {
                  "fieldName": "LogonType",
                  "parameterName": "LogonType",
                  "parameterType": 1
                },
                {
                  "fieldName": "MachineGroup",
                  "parameterName": "MachineGroup",
                  "parameterType": 1
                },
                {
                  "fieldName": "Protocol",
                  "parameterName": "Protocol",
                  "parameterType": 1
                },
                {
                  "fieldName": "RemoteDeviceName",
                  "parameterName": "RemoteDeviceName",
                  "parameterType": 1
                },
                {
                  "fieldName": "RemoteIP",
                  "parameterName": "RemoteIP",
                  "parameterType": 1
                },
                {
                  "fieldName": "RemoteIPType",
                  "parameterName": "RemoteIPType",
                  "parameterType": 1
                },
                {
                  "fieldName": "RemotePort",
                  "parameterName": "RemotePort",
                  "parameterType": 1
                },
                {
                  "fieldName": "ReportId",
                  "parameterName": "ReportId",
                  "parameterType": 1
                },
                {
                  "fieldName": "Timestamp",
                  "parameterName": "Timestamp",
                  "parameterType": 1
                },
                {
                  "fieldName": "TimeGenerated",
                  "parameterName": "TimeGenerated",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessParentCreationTime",
                  "parameterName": "InitiatingProcessParentCreationTime",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessCreationTime",
                  "parameterName": "InitiatingProcessCreationTime",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessFileSize",
                  "parameterName": "InitiatingProcessFileSize",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessVersionInfoCompanyName",
                  "parameterName": "InitiatingProcessVersionInfoCompanyName",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessVersionInfoFileDescription",
                  "parameterName": "InitiatingProcessVersionInfoFileDescription",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessVersionInfoInternalFileName",
                  "parameterName": "InitiatingProcessVersionInfoInternalFileName",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessVersionInfoOriginalFileName",
                  "parameterName": "InitiatingProcessVersionInfoOriginalFileName",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessVersionInfoProductName",
                  "parameterName": "InitiatingProcessVersionInfoProductName",
                  "parameterType": 1
                },
                {
                  "fieldName": "InitiatingProcessVersionInfoProductVersion",
                  "parameterName": "InitiatingProcessVersionInfoProductVersion",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceSystem",
                  "parameterName": "SourceSystem",
                  "parameterType": 1
                },
                {
                  "fieldName": "Type",
                  "parameterName": "Type",
                  "parameterType": 1
                }
              ],
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "filter": true
              }
            },
            "name": "Device Logon ResultList"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "name": "text - 5"
          },
          {
            "type": 1,
            "content": {
              "json": "- TenantId:\t**{TenantId}**\r\n- AccountDomain:\t**{AccountDomain}**\r\n- AccountName:\t**{AccountName}**\r\n- AccountSid:\t**{AccountSid}**\r\n- ActionType:\t**{ActionType}**\r\n- AdditionalFields:\t**{AdditionalFields}**\r\n- AppGuardContainerId:\t**{AppGuardContainerId}**\r\n- DeviceId:\t**{DeviceId}**\r\n- DeviceName:\t**{DeviceName}**\r\n- FailureReason:\t**{FailureReason}**\r\n- InitiatingProcessAccountDomain:\t**{InitiatingProcessAccountDomain}**\r\n- InitiatingProcessAccountName:\t**{InitiatingProcessAccountName}**\r\n- InitiatingProcessAccountObjectId:\t**{InitiatingProcessAccountObjectId}**\r\n- InitiatingProcessAccountSid:\t**{InitiatingProcessAccountSid}**\r\n- InitiatingProcessAccountUpn:\t**{InitiatingProcessAccountUpn}**\r\n- InitiatingProcessCommandLine:\t**{InitiatingProcessCommandLine}**\r\n- InitiatingProcessFileName:\t**{InitiatingProcessFileName}**\r\n- InitiatingProcessFolderPath:\t**{InitiatingProcessFolderPath}**\r\n- InitiatingProcessId:\t**{InitiatingProcessId}**\r\n- InitiatingProcessIntegrityLevel:\t**{InitiatingProcessIntegrityLevel}**\r\n- InitiatingProcessMD5:\t**{InitiatingProcessMD5}**\r\n- InitiatingProcessParentFileName:\t**{InitiatingProcessParentFileName}**\r\n- InitiatingProcessParentId:\t**{InitiatingProcessParentId}**\r\n- InitiatingProcessSHA1:\t**{InitiatingProcessSHA1}**\r\n- InitiatingProcessSHA256:\t**{InitiatingProcessSHA256}**\r\n- InitiatingProcessTokenElevation:\t**{InitiatingProcessTokenElevation}**\r\n- IsLocalAdmin:\t**{IsLocalAdmin}**\r\n- LogonId:\t**{LogonId}**\r\n- LogonType:\t**{LogonType}**\r\n- MachineGroup:\t**{MachineGroup}**\r\n- Protocol:\t**{Protocol}**\r\n- RemoteDeviceName:\t**{RemoteDeviceName}**\r\n- RemoteIP:\t**{RemoteIP}**\r\n- RemoteIPType:\t**{RemoteIPType}**\r\n- RemotePort:\t**{RemotePort}**\r\n- ReportId:\t**{ReportId}**\r\n- Timestamp:\t**{Timestamp}**\r\n- TimeGenerated:\t**{TimeGenerated}**\r\n- InitiatingProcessParentCreationTime:\t**{InitiatingProcessParentCreationTime}**\r\n- InitiatingProcessCreationTime:\t**{InitiatingProcessCreationTime}**\r\n- InitiatingProcessFileSize:\t**{InitiatingProcessFileSize}**\r\n- InitiatingProcessVersionInfoCompanyName:\t**{InitiatingProcessVersionInfoCompanyName}**\r\n- InitiatingProcessVersionInfoFileDescription:\t**{InitiatingProcessVersionInfoFileDescription}**\r\n- InitiatingProcessVersionInfoInternalFileName:\t**{InitiatingProcessVersionInfoInternalFileName}**\r\n- InitiatingProcessVersionInfoOriginalFileName:\t**{InitiatingProcessVersionInfoOriginalFileName}**\r\n- InitiatingProcessVersionInfoProductName:\t**{InitiatingProcessVersionInfoProductName}**\r\n- InitiatingProcessVersionInfoProductVersion:\t**{InitiatingProcessVersionInfoProductVersion}**\r\n- SourceSystem:\t**{SourceSystem}**\r\n- Type:\t**{Type}**"
            },
            "name": "Devcie LogonResultDetail"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "switchTabs",
        "comparison": "isEqualTo",
        "value": "Device_Logon_Activity"
      },
      "name": "Device Logon Activity "
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Office Activity",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "07aaa63f-2ac6-437b-a003-fa82871c68e9",
                  "version": "KqlParameterItem/1.0",
                  "name": "Para_Office_Activity_UserID",
                  "label": "UserID",
                  "type": 1,
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "Office_Activity_Parameters"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "OfficeActivity\r\n| where UserId contains \"{Para_Office_Activity_UserID}\"\r\n| summarize Count = count() by UserId\r\n| sort by Count desc",
              "size": 0,
              "timeContextFromParameter": "TimeRange",
              "exportMultipleValues": true,
              "exportedParameters": [
                {
                  "fieldName": "UserId",
                  "parameterName": "Office_Activity_UserID",
                  "parameterType": 1
                }
              ],
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AccountName",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "name": "User Filter"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "07aaa63f-2ac6-437b-a003-fa82871c68e9",
                  "version": "KqlParameterItem/1.0",
                  "name": "Office_Activity_RecordType",
                  "label": "RecordType",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "let Office_Activity_UserIDs = dynamic([{Office_Activity_UserID}]);\r\nOfficeActivity\r\n| where UserId in (Office_Activity_UserIDs)\r\n| distinct RecordType",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "Office_Activity_Parameters",
            "styleSettings": {
              "maxWidth": "13%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Office_Activity_UserIDs = dynamic([{Office_Activity_UserID}]);\r\nOfficeActivity\r\n| where UserId in (Office_Activity_UserIDs)\r\n| summarize Count = count() by RecordType\r\n| sort by Count desc",
              "size": 0,
              "noDataMessage": "Select a user to start.",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AppDisplayName",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "Application Filter",
            "styleSettings": {
              "maxWidth": "20%"
            }
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "e3b28f3c-1da1-4e40-b22d-2a109e5fee67",
                  "version": "KqlParameterItem/1.0",
                  "name": "Office_Activity_Operation",
                  "label": "Operation",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "let Office_Activity_UserIDs = dynamic([{Office_Activity_UserID}]);\r\nlet Office_Activity_RecordTypes = dynamic([{Office_Activity_RecordType}]);\r\nOfficeActivity\r\n| where UserId in (Office_Activity_UserIDs)\r\n| where RecordType in (Office_Activity_RecordTypes)\r\n| distinct Operation",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "Office_Activity_Parameters - Copy",
            "styleSettings": {
              "maxWidth": "13%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Office_Activity_UserIDs = dynamic([{Office_Activity_UserID}]);\r\nlet Office_Activity_RecordTypes = dynamic([{Office_Activity_RecordType}]);\r\nOfficeActivity\r\n| where UserId in (Office_Activity_UserIDs)\r\n| where RecordType in (Office_Activity_RecordTypes)\r\n| summarize Count = count() by Operation\r\n| sort by Count desc",
              "size": 0,
              "noDataMessage": "Select a user to start.",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AppDisplayName",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                ],
                "rowLimit": 1000,
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "Action Filter",
            "styleSettings": {
              "maxWidth": "20%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Office_Activity_UserIDs = dynamic([{Office_Activity_UserID}]);\r\nlet Office_Activity_RecordTypes = dynamic([{Office_Activity_RecordType}]);\r\nlet Office_Activity_Operations = dynamic([{Office_Activity_Operation}]);\r\nOfficeActivity\r\n| where UserId in (Office_Activity_UserIDs)\r\n| where RecordType in (Office_Activity_RecordTypes)\r\n| where Operation in (Office_Activity_Operations)",
              "size": 0,
              "title": "Result List",
              "noDataMessage": "Select a user to start.",
              "timeContext": {
                "durationMs": 86400000
              },
              "showRefreshButton": true,
              "exportedParameters": [
                {
                  "fieldName": "TenantId",
                  "parameterName": "TenantId",
                  "parameterType": 1
                },
                {
                  "fieldName": "Application",
                  "parameterName": "Application",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserDomain",
                  "parameterName": "UserDomain",
                  "parameterType": 1
                },
                {
                  "fieldName": "Activity",
                  "parameterName": "Activity",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserAgent",
                  "parameterName": "UserAgent",
                  "parameterType": 1
                },
                {
                  "fieldName": "RecordType",
                  "parameterName": "RecordType",
                  "parameterType": 1
                },
                {
                  "fieldName": "TimeGenerated",
                  "parameterName": "TimeGenerated",
                  "parameterType": 1
                },
                {
                  "fieldName": "Operation",
                  "parameterName": "Operation",
                  "parameterType": 1
                },
                {
                  "fieldName": "OrganizationId",
                  "parameterName": "OrganizationId",
                  "parameterType": 1
                },
                {
                  "fieldName": "OrganizationId_",
                  "parameterName": "OrganizationId_",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserType",
                  "parameterName": "UserType",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserKey",
                  "parameterName": "UserKey",
                  "parameterType": 1
                },
                {
                  "fieldName": "OfficeWorkload",
                  "parameterName": "OfficeWorkload",
                  "parameterType": 1
                },
                {
                  "fieldName": "ResultStatus",
                  "parameterName": "ResultStatus",
                  "parameterType": 1
                },
                {
                  "fieldName": "ResultReasonType",
                  "parameterName": "ResultReasonType",
                  "parameterType": 1
                },
                {
                  "fieldName": "OfficeObjectId",
                  "parameterName": "OfficeObjectId",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserId",
                  "parameterName": "UserId",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserId_",
                  "parameterName": "UserId_",
                  "parameterType": 1
                },
                {
                  "fieldName": "ClientIP",
                  "parameterName": "ClientIP",
                  "parameterType": 1
                },
                {
                  "fieldName": "ClientIP_",
                  "parameterName": "ClientIP_",
                  "parameterType": 1
                },
                {
                  "fieldName": "Scope",
                  "parameterName": "Scope",
                  "parameterType": 1
                },
                {
                  "fieldName": "Site_",
                  "parameterName": "Site_",
                  "parameterType": 1
                },
                {
                  "fieldName": "ItemType",
                  "parameterName": "ItemType",
                  "parameterType": 1
                },
                {
                  "fieldName": "EventSource",
                  "parameterName": "EventSource",
                  "parameterType": 1
                },
                {
                  "fieldName": "Source_Name",
                  "parameterName": "Source_Name",
                  "parameterType": 1
                },
                {
                  "fieldName": "MachineDomainInfo",
                  "parameterName": "MachineDomainInfo",
                  "parameterType": 1
                },
                {
                  "fieldName": "MachineId",
                  "parameterName": "MachineId",
                  "parameterType": 1
                },
                {
                  "fieldName": "Site_Url",
                  "parameterName": "Site_Url",
                  "parameterType": 1
                },
                {
                  "fieldName": "Site_Url_",
                  "parameterName": "Site_Url_",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceRelativeUrl",
                  "parameterName": "SourceRelativeUrl",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceRelativeUrl_",
                  "parameterName": "SourceRelativeUrl_",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceFileName",
                  "parameterName": "SourceFileName",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceFileName_",
                  "parameterName": "SourceFileName_",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceFileExtension",
                  "parameterName": "SourceFileExtension",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestinationRelativeUrl",
                  "parameterName": "DestinationRelativeUrl",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestinationFileName",
                  "parameterName": "DestinationFileName",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestinationFileExtension",
                  "parameterName": "DestinationFileExtension",
                  "parameterType": 1
                },
                {
                  "fieldName": "UserSharedWith",
                  "parameterName": "UserSharedWith",
                  "parameterType": 1
                },
                {
                  "fieldName": "SharingType",
                  "parameterName": "SharingType",
                  "parameterType": 1
                },
                {
                  "fieldName": "CustomEvent",
                  "parameterName": "CustomEvent",
                  "parameterType": 1
                },
                {
                  "fieldName": "Event_Data",
                  "parameterName": "Event_Data",
                  "parameterType": 1
                },
                {
                  "fieldName": "ModifiedObjectResolvedName",
                  "parameterName": "ModifiedObjectResolvedName",
                  "parameterType": 1
                },
                {
                  "fieldName": "Parameters",
                  "parameterName": "Parameters",
                  "parameterType": 1
                },
                {
                  "fieldName": "ExternalAccess",
                  "parameterName": "ExternalAccess",
                  "parameterType": 1
                },
                {
                  "fieldName": "OriginatingServer",
                  "parameterName": "OriginatingServer",
                  "parameterType": 1
                },
                {
                  "fieldName": "OrganizationName",
                  "parameterName": "OrganizationName",
                  "parameterType": 1
                },
                {
                  "fieldName": "Logon_Type",
                  "parameterName": "Logon_Type",
                  "parameterType": 1
                },
                {
                  "fieldName": "InternalLogonType",
                  "parameterName": "InternalLogonType",
                  "parameterType": 1
                },
                {
                  "fieldName": "MailboxGuid",
                  "parameterName": "MailboxGuid",
                  "parameterType": 1
                },
                {
                  "fieldName": "MailboxOwnerUPN",
                  "parameterName": "MailboxOwnerUPN",
                  "parameterType": 1
                },
                {
                  "fieldName": "MailboxOwnerSid",
                  "parameterName": "MailboxOwnerSid",
                  "parameterType": 1
                },
                {
                  "fieldName": "MailboxOwnerMasterAccountSid",
                  "parameterName": "MailboxOwnerMasterAccountSid",
                  "parameterType": 1
                },
                {
                  "fieldName": "LogonUserSid",
                  "parameterName": "LogonUserSid",
                  "parameterType": 1
                },
                {
                  "fieldName": "LogonUserDisplayName",
                  "parameterName": "LogonUserDisplayName",
                  "parameterType": 1
                },
                {
                  "fieldName": "ClientInfoString",
                  "parameterName": "ClientInfoString",
                  "parameterType": 1
                },
                {
                  "fieldName": "Client_IPAddress",
                  "parameterName": "Client_IPAddress",
                  "parameterType": 1
                },
                {
                  "fieldName": "ClientMachineName",
                  "parameterName": "ClientMachineName",
                  "parameterType": 1
                },
                {
                  "fieldName": "ClientProcessName",
                  "parameterName": "ClientProcessName",
                  "parameterType": 1
                },
                {
                  "fieldName": "ClientVersion",
                  "parameterName": "ClientVersion",
                  "parameterType": 1
                },
                {
                  "fieldName": "Folder",
                  "parameterName": "Folder",
                  "parameterType": 1
                },
                {
                  "fieldName": "CrossMailboxOperations",
                  "parameterName": "CrossMailboxOperations",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestMailboxId",
                  "parameterName": "DestMailboxId",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestMailboxOwnerUPN",
                  "parameterName": "DestMailboxOwnerUPN",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestMailboxOwnerSid",
                  "parameterName": "DestMailboxOwnerSid",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestMailboxOwnerMasterAccountSid",
                  "parameterName": "DestMailboxOwnerMasterAccountSid",
                  "parameterType": 1
                },
                {
                  "fieldName": "DestFolder",
                  "parameterName": "DestFolder",
                  "parameterType": 1
                },
                {
                  "fieldName": "Folders",
                  "parameterName": "Folders",
                  "parameterType": 1
                },
                {
                  "fieldName": "AffectedItems",
                  "parameterName": "AffectedItems",
                  "parameterType": 1
                },
                {
                  "fieldName": "Item",
                  "parameterName": "Item",
                  "parameterType": 1
                },
                {
                  "fieldName": "ModifiedProperties",
                  "parameterName": "ModifiedProperties",
                  "parameterType": 1
                },
                {
                  "fieldName": "SendAsUserSmtp",
                  "parameterName": "SendAsUserSmtp",
                  "parameterType": 1
                },
                {
                  "fieldName": "SendAsUserMailboxGuid",
                  "parameterName": "SendAsUserMailboxGuid",
                  "parameterType": 1
                },
                {
                  "fieldName": "SendOnBehalfOfUserSmtp",
                  "parameterName": "SendOnBehalfOfUserSmtp",
                  "parameterType": 1
                },
                {
                  "fieldName": "SendonBehalfOfUserMailboxGuid",
                  "parameterName": "SendonBehalfOfUserMailboxGuid",
                  "parameterType": 1
                },
                {
                  "fieldName": "ExtendedProperties",
                  "parameterName": "ExtendedProperties",
                  "parameterType": 1
                },
                {
                  "fieldName": "Client",
                  "parameterName": "Client",
                  "parameterType": 1
                },
                {
                  "fieldName": "LoginStatus",
                  "parameterName": "LoginStatus",
                  "parameterType": 1
                },
                {
                  "fieldName": "Actor",
                  "parameterName": "Actor",
                  "parameterType": 1
                },
                {
                  "fieldName": "ActorContextId",
                  "parameterName": "ActorContextId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ActorIpAddress",
                  "parameterName": "ActorIpAddress",
                  "parameterType": 1
                },
                {
                  "fieldName": "InterSystemsId",
                  "parameterName": "InterSystemsId",
                  "parameterType": 1
                },
                {
                  "fieldName": "IntraSystemId",
                  "parameterName": "IntraSystemId",
                  "parameterType": 1
                },
                {
                  "fieldName": "SupportTicketId",
                  "parameterName": "SupportTicketId",
                  "parameterType": 1
                },
                {
                  "fieldName": "TargetContextId",
                  "parameterName": "TargetContextId",
                  "parameterType": 1
                },
                {
                  "fieldName": "DataCenterSecurityEventType",
                  "parameterName": "DataCenterSecurityEventType",
                  "parameterType": 1
                },
                {
                  "fieldName": "EffectiveOrganization",
                  "parameterName": "EffectiveOrganization",
                  "parameterType": 1
                },
                {
                  "fieldName": "ElevationTime",
                  "parameterName": "ElevationTime",
                  "parameterType": 1
                },
                {
                  "fieldName": "ElevationApprover",
                  "parameterName": "ElevationApprover",
                  "parameterType": 1
                },
                {
                  "fieldName": "ElevationApprovedTime",
                  "parameterName": "ElevationApprovedTime",
                  "parameterType": 1
                },
                {
                  "fieldName": "ElevationRequestId",
                  "parameterName": "ElevationRequestId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ElevationRole",
                  "parameterName": "ElevationRole",
                  "parameterType": 1
                },
                {
                  "fieldName": "ElevationDuration",
                  "parameterName": "ElevationDuration",
                  "parameterType": 1
                },
                {
                  "fieldName": "GenericInfo",
                  "parameterName": "GenericInfo",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceSystem",
                  "parameterName": "SourceSystem",
                  "parameterType": 1
                },
                {
                  "fieldName": "OfficeId",
                  "parameterName": "OfficeId",
                  "parameterType": 1
                },
                {
                  "fieldName": "SourceRecordId",
                  "parameterName": "SourceRecordId",
                  "parameterType": 1
                },
                {
                  "fieldName": "AzureActiveDirectory_EventType",
                  "parameterName": "AzureActiveDirectory_EventType",
                  "parameterType": 1
                },
                {
                  "fieldName": "AADTarget",
                  "parameterName": "AADTarget",
                  "parameterType": 1
                },
                {
                  "fieldName": "Start_Time",
                  "parameterName": "Start_Time",
                  "parameterType": 1
                },
                {
                  "fieldName": "OfficeTenantId",
                  "parameterName": "OfficeTenantId",
                  "parameterType": 1
                },
                {
                  "fieldName": "OfficeTenantId_",
                  "parameterName": "OfficeTenantId_",
                  "parameterType": 1
                },
                {
                  "fieldName": "TargetUserOrGroupName",
                  "parameterName": "TargetUserOrGroupName",
                  "parameterType": 1
                },
                {
                  "fieldName": "TargetUserOrGroupType",
                  "parameterName": "TargetUserOrGroupType",
                  "parameterType": 1
                },
                {
                  "fieldName": "MessageId",
                  "parameterName": "MessageId",
                  "parameterType": 1
                },
                {
                  "fieldName": "Members",
                  "parameterName": "Members",
                  "parameterType": 1
                },
                {
                  "fieldName": "TeamName",
                  "parameterName": "TeamName",
                  "parameterType": 1
                },
                {
                  "fieldName": "TeamGuid",
                  "parameterName": "TeamGuid",
                  "parameterType": 1
                },
                {
                  "fieldName": "ChannelType",
                  "parameterName": "ChannelType",
                  "parameterType": 1
                },
                {
                  "fieldName": "ChannelName",
                  "parameterName": "ChannelName",
                  "parameterType": 1
                },
                {
                  "fieldName": "ChannelGuid",
                  "parameterName": "ChannelGuid",
                  "parameterType": 1
                },
                {
                  "fieldName": "ExtraProperties",
                  "parameterName": "ExtraProperties",
                  "parameterType": 1
                },
                {
                  "fieldName": "AddOnType",
                  "parameterName": "AddOnType",
                  "parameterType": 1
                },
                {
                  "fieldName": "AddonName",
                  "parameterName": "AddonName",
                  "parameterType": 1
                },
                {
                  "fieldName": "TabType",
                  "parameterName": "TabType",
                  "parameterType": 1
                },
                {
                  "fieldName": "Name",
                  "parameterName": "Name",
                  "parameterType": 1
                },
                {
                  "fieldName": "OldValue",
                  "parameterName": "OldValue",
                  "parameterType": 1
                },
                {
                  "fieldName": "NewValue",
                  "parameterName": "NewValue",
                  "parameterType": 1
                },
                {
                  "fieldName": "ItemName",
                  "parameterName": "ItemName",
                  "parameterType": 1
                },
                {
                  "fieldName": "ChatThreadId",
                  "parameterName": "ChatThreadId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ChatName",
                  "parameterName": "ChatName",
                  "parameterType": 1
                },
                {
                  "fieldName": "CommunicationType",
                  "parameterName": "CommunicationType",
                  "parameterType": 1
                },
                {
                  "fieldName": "AADGroupId",
                  "parameterName": "AADGroupId",
                  "parameterType": 1
                },
                {
                  "fieldName": "AddOnGuid",
                  "parameterName": "AddOnGuid",
                  "parameterType": 1
                },
                {
                  "fieldName": "AppDistributionMode",
                  "parameterName": "AppDistributionMode",
                  "parameterType": 1
                },
                {
                  "fieldName": "TargetUserId",
                  "parameterName": "TargetUserId",
                  "parameterType": 1
                },
                {
                  "fieldName": "OperationScope",
                  "parameterName": "OperationScope",
                  "parameterType": 1
                },
                {
                  "fieldName": "AzureADAppId",
                  "parameterName": "AzureADAppId",
                  "parameterType": 1
                },
                {
                  "fieldName": "OperationProperties",
                  "parameterName": "OperationProperties",
                  "parameterType": 1
                },
                {
                  "fieldName": "AppId",
                  "parameterName": "AppId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ClientAppId",
                  "parameterName": "ClientAppId",
                  "parameterType": 1
                },
                {
                  "fieldName": "ApplicationId",
                  "parameterName": "ApplicationId",
                  "parameterType": 1
                },
                {
                  "fieldName": "SRPolicyId",
                  "parameterName": "SRPolicyId",
                  "parameterType": 1
                },
                {
                  "fieldName": "SRPolicyName",
                  "parameterName": "SRPolicyName",
                  "parameterType": 1
                },
                {
                  "fieldName": "SRRuleMatchDetails",
                  "parameterName": "SRRuleMatchDetails",
                  "parameterType": 1
                },
                {
                  "fieldName": "IsManagedDevice",
                  "parameterName": "IsManagedDevice",
                  "parameterType": 1
                },
                {
                  "fieldName": "ActorContextId_",
                  "parameterName": "ActorContextId_",
                  "parameterType": 1
                },
                {
                  "fieldName": "Type",
                  "parameterName": "Type",
                  "parameterType": 1
                },
                {
                  "fieldName": "_ResourceId",
                  "parameterName": "_ResourceId",
                  "parameterType": 1
                }
              ],
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "filter": true
              }
            },
            "name": "Office Activity Result List"
          },
          {
            "type": 1,
            "content": {
              "json": "- TenantId **{TenantId}**\r\n- Application **{Application}**\r\n- UserDomain **{UserDomain}**\r\n- Activity **{Activity}**\r\n- UserAgent **{UserAgent}**\r\n- RecordType **{RecordType}**\r\n- TimeGenerated **{TimeGenerated}**\r\n- Operation **{Operation}**\r\n- OrganizationId **{OrganizationId}**\r\n- OrganizationId_ **{OrganizationId_}**\r\n- UserType **{UserType}**\r\n- UserKey **{UserKey}**\r\n- OfficeWorkload **{OfficeWorkload}**\r\n- ResultStatus **{ResultStatus}**\r\n- ResultReasonType **{ResultReasonType}**\r\n- OfficeObjectId **{OfficeObjectId}**\r\n- UserId **{UserId}**\r\n- UserId_ **{UserId_}**\r\n- ClientIP **{ClientIP}**\r\n- ClientIP_ **{ClientIP_}**\r\n- Scope **{Scope}**\r\n- Site_ **{Site_}**\r\n- ItemType **{ItemType}**\r\n- EventSource **{EventSource}**\r\n- Source_Name **{Source_Name}**\r\n- MachineDomainInfo **{MachineDomainInfo}**\r\n- MachineId **{MachineId}**\r\n- Site_Url **{Site_Url}**\r\n- Site_Url_ **{Site_Url_}**\r\n- SourceRelativeUrl **{SourceRelativeUrl}**\r\n- SourceRelativeUrl_ **{SourceRelativeUrl_}**\r\n- SourceFileName **{SourceFileName}**\r\n- SourceFileName_ **{SourceFileName_}**\r\n- SourceFileExtension **{SourceFileExtension}**\r\n- DestinationRelativeUrl **{DestinationRelativeUrl}**\r\n- DestinationFileName **{DestinationFileName}**\r\n- DestinationFileExtension **{DestinationFileExtension}**\r\n- UserSharedWith **{UserSharedWith}**\r\n- SharingType **{SharingType}**\r\n- CustomEvent **{CustomEvent}**\r\n- Event_Data **{Event_Data}**\r\n- ModifiedObjectResolvedName **{ModifiedObjectResolvedName}**\r\n- Parameters **{Parameters}**\r\n- ExternalAccess **{ExternalAccess}**\r\n- OriginatingServer **{OriginatingServer}**\r\n- OrganizationName **{OrganizationName}**\r\n- Logon_Type **{Logon_Type}**\r\n- InternalLogonType **{InternalLogonType}**\r\n- MailboxGuid **{MailboxGuid}**\r\n- MailboxOwnerUPN **{MailboxOwnerUPN}**\r\n- MailboxOwnerSid **{MailboxOwnerSid}**\r\n- MailboxOwnerMasterAccountSid **{MailboxOwnerMasterAccountSid}**\r\n- LogonUserSid **{LogonUserSid}**\r\n- LogonUserDisplayName **{LogonUserDisplayName}**\r\n- ClientInfoString **{ClientInfoString}**\r\n- Client_IPAddress **{Client_IPAddress}**\r\n- ClientMachineName **{ClientMachineName}**\r\n- ClientProcessName **{ClientProcessName}**\r\n- ClientVersion **{ClientVersion}**\r\n- Folder **{Folder}**\r\n- CrossMailboxOperations **{CrossMailboxOperations}**\r\n- DestMailboxId **{DestMailboxId}**\r\n- DestMailboxOwnerUPN **{DestMailboxOwnerUPN}**\r\n- DestMailboxOwnerSid **{DestMailboxOwnerSid}**\r\n- DestMailboxOwnerMasterAccountSid **{DestMailboxOwnerMasterAccountSid}**\r\n- DestFolder **{DestFolder}**\r\n- Folders **{Folders}**\r\n- AffectedItems **{AffectedItems}**\r\n- Item **{Item}**\r\n- ModifiedProperties **{ModifiedProperties}**\r\n- SendAsUserSmtp **{SendAsUserSmtp}**\r\n- SendAsUserMailboxGuid **{SendAsUserMailboxGuid}**\r\n- SendOnBehalfOfUserSmtp **{SendOnBehalfOfUserSmtp}**\r\n- SendonBehalfOfUserMailboxGuid **{SendonBehalfOfUserMailboxGuid}**\r\n- ExtendedProperties **{ExtendedProperties}**\r\n- Client **{Client}**\r\n- LoginStatus **{LoginStatus}**\r\n- Actor **{Actor}**\r\n- ActorContextId **{ActorContextId}**\r\n- ActorIpAddress **{ActorIpAddress}**\r\n- InterSystemsId **{InterSystemsId}**\r\n- IntraSystemId **{IntraSystemId}**\r\n- SupportTicketId **{SupportTicketId}**\r\n- TargetContextId **{TargetContextId}**\r\n- DataCenterSecurityEventType **{DataCenterSecurityEventType}**\r\n- EffectiveOrganization **{EffectiveOrganization}**\r\n- ElevationTime **{ElevationTime}**\r\n- ElevationApprover **{ElevationApprover}**\r\n- ElevationApprovedTime **{ElevationApprovedTime}**\r\n- ElevationRequestId **{ElevationRequestId}**\r\n- ElevationRole **{ElevationRole}**\r\n- ElevationDuration **{ElevationDuration}**\r\n- GenericInfo **{GenericInfo}**\r\n- SourceSystem **{SourceSystem}**\r\n- OfficeId **{OfficeId}**\r\n- SourceRecordId **{SourceRecordId}**\r\n- AzureActiveDirectory_EventType **{AzureActiveDirectory_EventType}**\r\n- AADTarget **{AADTarget}**\r\n- Start_Time **{Start_Time}**\r\n- OfficeTenantId **{OfficeTenantId}**\r\n- OfficeTenantId_ **{OfficeTenantId_}**\r\n- TargetUserOrGroupName **{TargetUserOrGroupName}**\r\n- TargetUserOrGroupType **{TargetUserOrGroupType}**\r\n- MessageId **{MessageId}**\r\n- Members **{Members}**\r\n- TeamName **{TeamName}**\r\n- TeamGuid **{TeamGuid}**\r\n- ChannelType **{ChannelType}**\r\n- ChannelName **{ChannelName}**\r\n- ChannelGuid **{ChannelGuid}**\r\n- ExtraProperties **{ExtraProperties}**\r\n- AddOnType **{AddOnType}**\r\n- AddonName **{AddonName}**\r\n- TabType **{TabType}**\r\n- Name **{Name}**\r\n- OldValue **{OldValue}**\r\n- NewValue **{NewValue}**\r\n- ItemName **{ItemName}**\r\n- ChatThreadId **{ChatThreadId}**\r\n- ChatName **{ChatName}**\r\n- CommunicationType **{CommunicationType}**\r\n- AADGroupId **{AADGroupId}**\r\n- AddOnGuid **{AddOnGuid}**\r\n- AppDistributionMode **{AppDistributionMode}**\r\n- TargetUserId **{TargetUserId}**\r\n- OperationScope **{OperationScope}**\r\n- AzureADAppId **{AzureADAppId}**\r\n- OperationProperties **{OperationProperties}**\r\n- AppId **{AppId}**\r\n- ClientAppId **{ClientAppId}**\r\n- ApplicationId **{ApplicationId}**\r\n- SRPolicyId **{SRPolicyId}**\r\n- SRPolicyName **{SRPolicyName}**\r\n- SRRuleMatchDetails **{SRRuleMatchDetails}**\r\n- IsManagedDevice **{IsManagedDevice}**\r\n- ActorContextId_ **{ActorContextId_}**\r\n- Type **{Type}**\r\n- _ResourceId **{_ResourceId}**"
            },
            "name": "text - 7"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "switchTabs",
        "comparison": "isEqualTo",
        "value": "Office_Activity"
      },
      "name": "Office Activity"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Azure Activity",
        "items": []
      },
      "conditionalVisibility": {
        "parameterName": "switchTabs",
        "comparison": "isEqualTo",
        "value": "Azure_Activity"
      },
      "name": "Azure Activity"
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/74f0db80-614b-4242-a56f-da0c0da36ff0/resourcegroups/lianbio-prod-sentinel/providers/microsoft.operationalinsights/workspaces/lianbio-prod-sentinel-workspace"
  ],
  "fromTemplateId": "sentinel-UserWorkbook",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}

